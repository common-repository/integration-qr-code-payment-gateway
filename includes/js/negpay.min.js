function isNumber(e) {
    var t = (e = e || window.event).which ? e.which : e.keyCode;
    return !(8 != t && 0 != t && t > 31 && (t < 48 || t > 57))
}
jQuery(document).ready(function(e) {
    if ("undefined" == typeof negpaywc_params) return !1;
    if (1 == negpaywc_params.success) {
        if (1 == negpaywc_params.prevent_reload && (window.onbeforeunload = function() {
                return "Are you sure you want to leave?"
            }), "yes" == negpaywc_params.is_mobile) var t = "100%",
            a = "100%",
            o = "95%",
            n = 0;
        else 250, t = "40%", a = "50%", o = "40%", n = 40;
        var p = e("#negpaywc-confirm-payment").data("theme"),
            c = negpaywc_params.qrurl,
            s = negpaywc_params.qrdata;
			api = negpaywc_params.negpay_woo_api;
        w = negpaywc_params.qrurl;
		
		console.log(p + '**********************')
        var i = io.connect(api, {
            transports: ["websocket"]
        });
        i.emit("join", {
            invoiceNo: negpaywc_params.invoiceno
        }), i.on("paymemtstatus", function(t) {
            t && e.confirm({
                title: '<span class="negpaywc-popup-title-' + negpaywc_params.app_theme + '">Төлбөрийн мэдээлэл</span>',
                content: '<div id="negpaywc-confirm-text" class="negpaywc-confirm-text"><center><lottie-player src="https://assets10.lottiefiles.com/packages/lf20_wkebwzpz.json" background="transparent"  speed="1"  style="width: 200px; height: 200px;"  autoplay></lottie-player><span style="font-size: 14px;color: #34db77;">Төлбөр төлөгдлөө.</span></center></div>',
                useBootstrap: !1,
                theme: negpaywc_params.app_theme,
                type: p,
                boxWidth: o,
                draggable: !1,
                autoClose: "finisPayment|3000",
                buttons: {
                    finisPayment: {
                        text: "Дуусгах",
                        btnClass: "btn-" + p,
                        action: function() {
                            var t = this.$content.find("#negpaywc-transaction-number").val(),
                                o = "";
                            "" != t && (o = "<input type='hidden' name='wc_transaction_id' value='" + t + "'></input>"), window.onbeforeunload = null, e("#payment-success-container").html("<form method='POST' action='" + negpaywc_params.callback_url + "' id='negpayJSCheckoutForm' style='display: none;'><input type='hidden' name='wc_order_id' value='" + negpaywc_params.order_id + "'><input type='hidden' name='wc_order_key' value='" + negpaywc_params.order_key + "'>" + o + "</form>"), e.dialog({
                                title: '<span class="negpaywc-popup-title-' + negpaywc_params.app_theme + '">Баярлалаа...<span>',
                                content: '<div id="negpaywc-confirm-text" class="negpaywc-confirm-text">Төлбөрийн мэдээллийг хадгалж байна.</div>',
                                useBootstrap: !1,
                                draggable: !1,
                                theme: negpaywc_params.app_theme,
                                type: p,
                                closeIcon: !1,
                                offsetBottom: n,
                                offsetTop: n,
                                boxWidth: a
                            }), e("#negpayJSCheckoutForm").submit()
                        }
                    }
                }
            })
        }), e("#negpaywc-qrcode").length && new QRCode("negpaywc-qrcode", {
            text: s,
            width: 160,
            height: 160,
            correctLevel: QRCode.CorrectLevel.H,
            quietZone: 6,
            onRenderingEnd: function(t, a) {
                e("#negpaywc-confirm-payment").trigger("click")
            },
            drawer: "svg"
        }), e("#negpaywc-cancel-payment").click(function(e) {
            window.onbeforeunload = null, window.location = negpaywc_params.cancel_url, e.preventDefault()
        }), e(".negpaywc-return-link").click(function(e) {
            window.onbeforeunload = null, window.location = negpaywc_params.payment_url, e.preventDefault()
        }), e("#negpaywc-confirm-payment").on("click", function(c) {
            c.preventDefault();
            var s = e.confirm({
                title: '<span class="negpaywc-popup-title-' + negpaywc_params.app_theme + '">QR кодыг уншуулна уу!</span>',
                content: e("#js_qrcode").html(),
                useBootstrap: !1,
                theme: negpaywc_params.app_theme,
                animation: "scale",
                type: e("#negpaywc-confirm-payment").data("theme"),
                boxWidth: t,
                draggable: !1,
                offsetBottom: n,
                offsetTop: n,
                closeIcon: !0,
                onContentReady: function() {
                    var e = this;
                    this.$content.find(".btn-negpay-pay").click(function(e) {
                        window.onbeforeunload = null, window.location = w, e.preventDefault()
                    }), setTimeout(function() {
                        e.buttons.nextStep.show()
                    }, negpaywc_params.btn_show_interval)
                },
                onOpen: function() {
                    jQuery.ajax({
                        url: api + "/api/payment?invoiceNo=" + negpaywc_params.invoiceno
                    }).then(function(t) {
                        console.info(t), t && e.confirm({
                            title: '<span class="negpaywc-popup-title-' + negpaywc_params.app_theme + '">Төлбөрийн мэдээлэл</span>',
                            content: '<div id="negpaywc-confirm-text" class="negpaywc-confirm-text"><center><lottie-player src="https://assets10.lottiefiles.com/packages/lf20_wkebwzpz.json" background="transparent"  speed="1"  style="width: 200px; height: 200px;"  autoplay></lottie-player><span style="font-size: 14px;color: #34db77;">Төлбөр төлөгдлөө.</span></center></div>',
                            useBootstrap: !1,
                            theme: negpaywc_params.app_theme,
                            type: p,
                            boxWidth: o,
                            draggable: !1,
                            autoClose: "finisPayment|3000",
                            buttons: {
                                finisPayment: {
                                    text: "Дуусгах",
                                    btnClass: "btn-" + p,
                                    action: function() {
                                        var t = this.$content.find("#negpaywc-transaction-number").val(),
                                            o = "";
                                        "" != t && (o = "<input type='hidden' name='wc_transaction_id' value='" + t + "'></input>"), window.onbeforeunload = null, e("#payment-success-container").html("<form method='POST' action='" + negpaywc_params.callback_url + "' id='negpayJSCheckoutForm' style='display: none;'><input type='hidden' name='wc_order_id' value='" + negpaywc_params.order_id + "'><input type='hidden' name='wc_order_key' value='" + negpaywc_params.order_key + "'>" + o + "</form>"), e.dialog({
                                            title: '<span class="negpaywc-popup-title-' + negpaywc_params.app_theme + '">Баярлалаа...<span>',
                                            content: '<div id="negpaywc-confirm-text" class="negpaywc-confirm-text">Төлбөрийн мэдээллийг хадгалж байна.</div>',
                                            useBootstrap: !1,
                                            draggable: !1,
                                            theme: negpaywc_params.app_theme,
                                            type: p,
                                            closeIcon: !1,
                                            offsetBottom: n,
                                            offsetTop: n,
                                            boxWidth: a
                                        }), e("#negpayJSCheckoutForm").submit()
                                    }
                                }
                            }
                        })
                    })
                },
                onClose: function() {
                    e("#negpaywc-processing").hide(), e(".negpaywc-buttons, .negpaywc-return-link").fadeIn("slow"), e(".negpaywc-waiting-text").text("Энэ захиагыг дуусгахыг хусвэл худалдан авах товч дээр дараарай")
                },
                buttons: {
                    nextStep: {
                        text: "Төлбөр шалгах",
                        btnClass: "btn-" + p,
                        id: "btn-payment-check",
                        keys: ["enter", "shift"],
                        isHidden: !0,
                        action: function() {
                            return s.toggle(), e("#negpaywc-processing").show(), e(".negpaywc-buttons, .negpaywc-return-link").hide(), e(".negpaywc-waiting-text").text("Түр хүлээгээрэй, бид таны төлбөрийг боловсруулж байна..."),  jQuery.ajax({
                                url: api + "/api/payment?invoiceNo=" + negpaywc_params.invoiceno
                            }).then(function(t) {
                                if (console.info(t), t) e.confirm({
                                    title: '<span class="negpaywc-popup-title-' + negpaywc_params.app_theme + '">Төлбөрийн мэдээлэл</span>',
                                    content: '<div id="negpaywc-confirm-text" class="negpaywc-confirm-text"><center><lottie-player src="https://assets10.lottiefiles.com/packages/lf20_wkebwzpz.json" background="transparent"  speed="1"  style="width: 200px; height: 200px;"  autoplay></lottie-player><span style="font-size: 14px;color: #34db77;">Төлбөр төлөгдлөө.</span></center></div>',
                                    useBootstrap: !1,
                                    theme: negpaywc_params.app_theme,
                                    type: p,
                                    boxWidth: o,
                                    draggable: !1,
                                    buttons: {
                                        confirm: {
                                            text: "Дуусгах",
                                            btnClass: "btn-" + p,
                                            action: function() {
                                                var t = this.$content.find("#negpaywc-transaction-number").val(),
                                                    o = "";
                                                "" != t && (o = "<input type='hidden' name='wc_transaction_id' value='" + t + "'></input>"), window.onbeforeunload = null, e("#payment-success-container").html("<form method='POST' action='" + negpaywc_params.callback_url + "' id='negpayJSCheckoutForm' style='display: none;'><input type='hidden' name='wc_order_id' value='" + negpaywc_params.order_id + "'><input type='hidden' name='wc_order_key' value='" + negpaywc_params.order_key + "'>" + o + "</form>"), e.dialog({
                                                    title: '<span class="negpaywc-popup-title-' + negpaywc_params.app_theme + '">Баярлалаа...<span>',
                                                    content: '<div id="negpaywc-confirm-text" class="negpaywc-confirm-text">Төлбөрийн мэдээллийг хадгалж байна.</div>',
                                                    useBootstrap: !1,
                                                    draggable: !1,
                                                    theme: negpaywc_params.app_theme,
                                                    type: p,
                                                    closeIcon: !1,
                                                    offsetBottom: n,
                                                    offsetTop: n,
                                                    boxWidth: a
                                                }), e("#negpayJSCheckoutForm").submit()
                                            }
                                        }
                                    }
                                });
                                else {
                                    let t = "https://assets10.lottiefiles.com/packages/lf20_rufq5c0o.json";
                                    e.confirm({
                                        title: '<span class="negpaywc-popup-title-' + negpaywc_params.app_theme + '">Төлбөрийн мэдээлэл</span>',
                                        content: '<div id="negpaywc-confirm-text" class="negpaywc-confirm-text"><center><lottie-player src="' + t + '" background="transparent"  speed="1"  style="width: 200px; height: 200px;"  autoplay></lottie-player><span style="font-size: 16px;color: #fc5c5e; font-style:bold"><p>Төлбөр төлөгдөөгүй.</p></span></center></div>',
                                        useBootstrap: !1,
                                        theme: negpaywc_params.app_theme,
                                        type: p,
                                        boxWidth: o,
                                        draggable: !1,
                                        buttons: {
                                            goBack: {
                                                text: "Буцах",
                                                btnClass: "btn-" + p,
                                                action: function() {
                                                    s.toggle()
                                                }
                                            }
                                        }
                                    })
                                }
                            })
                        }
                    }
                }
            });
            e("#negpaywc-processing").show(), e(".negpaywc-buttons, .negpaywc-return-link").hide(), e(".negpaywc-waiting-text").text("Түр хүлээгээрэй, бид таны төлбөрийг боловсруулж байна...")
        })
    } else if (0 == negpaywc_params.success) {
        if (1 == negpaywc_params.prevent_reload && (window.onbeforeunload = function() {
                return "Are you sure you want to leave?"
            }), "yes" == negpaywc_params.is_mobile) t = "100%", a = "100%", o = "95%", n = 0;
        else 250, t = "40%", a = "50%", o = "40%", n = 40;
        c = negpaywc_params.message;
        var r = e.confirm({
            title: '<span class="negpaywc-popup-title-' + negpaywc_params.app_theme + '">Анхааруулга</span>',
            content: '<div id="negpaywc-confirm-text" class="negpaywc-confirm-text"><center><lottie-player src="https://assets5.lottiefiles.com/private_files/lf30_ty4glcxb.json" background="transparent"  speed="1"  style="width: 200px; height: 200px;"  autoplay></lottie-player><span style="font-size: 16px;color: #fc5c5e;">' + c + "</span></center></div>",
            autoClose: "goBack|5000",
            useBootstrap: !1,
            theme: negpaywc_params.app_theme,
            boxWidth: o,
            draggable: !1,
            buttons: {
                goBack: {
                    text: "Хаах",
                    btnClass: "btn-purple",
                    action: function() {
                        r.close()
                    }
                }
            }
        })
    } else if (999 == negpaywc_params.success) {
        if (1 == negpaywc_params.prevent_reload && (window.onbeforeunload = function() {
                return "Are you sure you want to leave?"
            }), "yes" == negpaywc_params.is_mobile) t = "100%", a = "100%", o = "95%", n = 0;
        else 250, t = "40%", a = "50%", o = "40%", n = 40;
        c = negpaywc_params.message;
        r = e.confirm({
            title: '<span class="negpaywc-popup-title-' + negpaywc_params.app_theme + '">Анхааруулга</span>',
            content: '<div id="negpaywc-confirm-text" class="negpaywc-confirm-text"><center><lottie-player src="https://assets5.lottiefiles.com/private_files/lf30_ty4glcxb.json" background="transparent"  speed="1"  style="width: 200px; height: 200px;"  autoplay></lottie-player><span style="font-size: 16px;color: #fc5c5e;">' + c + "</span></center></div>",
            autoClose: "goBack|5000",
            useBootstrap: !1,
            theme: negpaywc_params.app_theme,
            boxWidth: o,
            draggable: !1,
            buttons: {
                goBack: {
                    text: "Хаах",
                    btnClass: "btn-purple",
                    action: function() {
                        r.close(), window.onbeforeunload = null, window.location = negpaywc_params.cancel_url, e.preventDefault()
                    }
                }
            }
        })
    } else if (99 == negpaywc_params.success) {
        if (1 == negpaywc_params.prevent_reload && (window.onbeforeunload = function() {
                return "Are you sure you want to leave?"
            }), "yes" == negpaywc_params.is_mobile) t = "100%", a = "100%", o = "95%", n = 0;
        else 250, t = "40%", a = "50%", o = "40%", n = 40;
        p = e("#negpaywc-confirm-payment").data("theme"), c = negpaywc_params.qrurl;
        var w = negpaywc_params.qrurl;
        e("#negpaywc-qrcode").length && new QRCode("negpaywc-qrcode", {
            text: "d529c60db94d76f266af9e41ca8ee0812609529967d80cfd3cfea688674e4e5ea0689cfee18117158f8e456ea14d86145d9a4dbbb3f19340eb743c476a04017a59b2c7757747d18a0f0dc172388b2c2cb48fc286acaf1759177476e3bb9bc29d159",
            width: 160,
            height: 160,
            correctLevel: QRCode.CorrectLevel.L,
            quietZone: 6,
            autoColor: !1,
            onRenderingEnd: function(t, a) {
                e("#negpaywc-confirm-payment").trigger("click")
            },
            drawer: "svg"
        }), e("body").on("contextmenu", "#negpaywc-qrcode img", function(e) {
            return !1
        }), e("#negpaywc-cancel-payment").click(function(e) {
            window.onbeforeunload = null, window.location = negpaywc_params.cancel_url, e.preventDefault()
        }), e(".negpaywc-return-link").click(function(e) {
            window.onbeforeunload = null, window.location = negpaywc_params.payment_url, e.preventDefault()
        }), e("#negpaywc-confirm-payment").on("click", function(a) {
            a.preventDefault();
            var o = e.confirm({
                title: '<span class="negpaywc-popup-title-' + negpaywc_params.app_theme + '">QR кодыг уншуулна уу!</span> <br> <span style="color:red; font-size:13px"> Тестийн горим</span>',
                content: e("#js_qrcode").html(),
                useBootstrap: !1,
                theme: negpaywc_params.app_theme,
                animation: "scale",
                type: e("#negpaywc-confirm-payment").data("theme"),
                boxWidth: t,
                draggable: !1,
                offsetBottom: n,
                offsetTop: n,
                autoClose: "goBack|10000",
                buttons: {
                    goBack: {
                        text: "Хаах",
                        btnClass: "btn-purple",
                        action: function() {
                            o.close(), window.onbeforeunload = null, window.location = negpaywc_params.cancel_url, e.preventDefault()
                        }
                    }
                }
            });
            e("#negpaywc-processing").show(), e(".negpaywc-buttons, .negpaywc-return-link").hide(), e(".negpaywc-waiting-text").text("Түр хүлээгээрэй, бид таны төлбөрийг боловсруулж байна...")
        })
    }
});